# 资源限制 {#intro}

为了避免资源滥用，确保平台的稳定性，AirCode 中每一个账号及应用均拥有相应的资源限制，超出限制可能会导致调用或部署失败。

如果你的用量已经超过限额，或预期需要更多资源，请发送邮件到 [support@aircode.io](mailto:support@aircode.io?subject=Get%20information%20on%20the%20Paid%20Upgrade%20Plan%20of%20AirCode) 获取帮助和付费升级方案。

## 每月用量限制 {#monthly-usage}

每个账户下的**所有应用**，每月用量之和不能超过以下值。

| 项目 | Free 版账户 |
| :---- | :---- |
| 云函数调用次数 | 1,000,000 |
| 云函数运行时长 | 7,200 秒 |
| 云函数入网流量 | 1 TB |
| 云函数出网流量 | 10 GB |
| 数据库读次数 | 2,000,000 |
| 数据库写次数 | 200,000 |
| 文件上传次数 | 200,000 |
| 文件上传总流量 | 64 GB |
| 文件下载次数 | 1,000,000 |
| 文件下载总流量 | 256 GB |
| 文件总空间 | 256 GB |
| 应用部署次数 | 600 |
| 应用部署总时长 | 14,400 秒 |

## 云函数 {#functions}

以下所有限制均为**单应用**级别。

### 数量及大小 {#functions-size}

- 云函数文件数量：**128**，包含所有 `.js` 后缀的云函数和非 `.js` 后缀的文件
- 文件名长度：**64 字符**，文件名长度包括扩展名
- 部署大小：打包后不超过 **128 MB**，解压缩后不超过 **512 MB**，包含所有云函数及依赖包
- 单个函数文件大小：**5 MB**

### 运行时限制 {#functions-runtime}

- 运行时内存：**512 MB**
- 磁盘空间（即 `/tmp` 目录）：**10 GB**
- 函数运行超时时间：默认为 **60 秒**，可设置范围 **5 至 90 秒**

### 请求限制 {#functions-invoke}

- 每秒请求数（QPS）：**200**，即同一应用每秒最多处理 200 个函数请求
- 访问并发：**20**，即同一应用同时在处理的请求数不能超过 20 个
- 请求负载大小：**4.5 MB**，即单次的 Request Body 及 Response Body 大小均不能超过 4.5 MB
- 入网数据流量：**1 GB/s**
- 出网数据流量：**1 MB/s**

### 实例伸缩 {#functions-instance-scaling}

- 最低实例数：**0 个**，即当流量降低时，最低会缩容到 0 实例。若你希望能够保留常驻实例，请发送邮件到 [support@aircode.io](mailto:support@aircode.io?subject=Get%20information%20on%20the%20Paid%20Upgrade%20Plan%20of%20AirCode) 获取帮助和付费升级方案
- 最高实例数：**100 个**，即当流量升高时，最多会扩容至 100 个实例

### 冷启动 {#functions-cold-start}

- 进入「闲置」时间：**1 小时**。即 1 小时内没有任何调用发生的服务将可能进入「闲置」状态
- 冷启动预估时间：**300 毫秒**。即第一次调用「闲置」状态的服务时，调用时间会增长 300 毫秒

::: tip 提示
1. 冷启动的所有时间数据仅为预估值，实际中根据业务复杂度、代码包大小和网络情况等会有出入
2. 关于冷启动的说明可参考[云函数运行时 - 冷启动](/reference/server/functions-runtime#cold-start)
:::

### 环境变量 {#functions-environments}

- Key 和 Value 规则
  - Key 必须以大小写字母开头，只能包括大小写字母和数字，且不能以 `AC_` 开头
  - Value 必须是可显示的 ASCII 字符，不能包含中文等其他字符
- 环境变量个数：**512 个**
- 环境变量总大小：**3 KB**，即所有环境变量的大小总和不能超过 3 KB
- 系统预留环境变量：所有以 `AC_` 开头的名称均为系统环境变量，因此自定义环境变量的 Key 不能以 `AC_` 开头

::: tip 提示
关于环境变量的设置和使用，可参考[使用环境变量](/guide/functions/env)。
:::

## 线上日志 {#logs}

以下所有限制均为**单应用**级别。

### 日志产生 {#logs-generate}

- 单条日志大小：**32 KB**，超过部分会被舍弃
- 产生日志数：**100 条/s**，超过部分会被舍弃
- 产生日志流量：**128 KB/s**，超过部分会被舍弃

### 日志查看和查询 {#logs-view-and-query}

- 单条日志显示大小：**2,048 字符**，对于超过 2048 个字符的单条日志，只显示前 2048 个字符
- 时间查询限制：**最近 7 天**，即最远可查询到 7 天前的日志
- 关键词查询限制：**20 个**，即每次查询最多输入 20 个关键词

::: tip 提示
关于产生和查看线上日志的教程，可参考[线上日志](/guide/functions/logs)。
:::

## 数据库 {#database}

以下所有限制均为**单应用**级别。

### 表限制 {#database-size}

- 表数量：**128**，即单个应用中，包括以 `_` 开头的系统表在内不能超过 128 个表
- 表名限制：**不能包含 `$` 字符，且不能以 `_` 或 `system.` 开头**
- 表名长度：**64 字符**
- 单表索引数：**64**

### 写入限制 {#database-write}

- 单条记录数据量大小：**16 MB**
- 批量写入最大总条数：**100**，即使用 `save` 进行[批量插入](/guide/database/insert#insert-multiple)或[批量更新](/guide/database/update#update-multiple)时，单次传入的记录条数不能超过 100
- 批量写入总数据量：**128 MB**，即使用 `save` 进行[批量插入](/guide/database/insert#insert-multiple)或[批量更新](/guide/database/update#update-multiple)时，单次传入的所有记录的总大小不能超过 128 MB，注意单条记录的数据量大小仍然有 16 MB 的限制

::: tip 提示
使用[直接执行更新](/guide/database/update#set-and-save)的方式更新数据时，不受写入总条数的限制。当需要同时更新大量数据时，建议采用这种方式。
:::

### 查询限制 {#database-find}

- 单次查询超时时间：**5 秒**
- 单次查询最大条数：**10,000**，当实际查询到的条数超过 10,000 时，会仅返回前 10,000 条记录
- 单次查询总数据量：**128 MB**，当单次查询到的所有记录总大小超过 128 MB 时，会查询失败

::: tip 提示
对于记录条数过多、数据量较大或耗时较长的查询，建议使用[索引优化查询](/guide/database/indexes)，并使用[排序和分页](/guide/database/find#sort-and-pagination)减少单次返回的条数和数据量。
:::

### 删除限制 {#database-delete}

- 单次删除最大条数：**100**，当单次删除时传入的 `_id` 数量超过 100 条时，会删除失败

::: tip 提示
使用[直接执行删除](/guide/database/delete#delete-directly)的方式删除数据时，不受删除最大条数的限制。当需要同时删除大量数据时，建议采用这种方式。
:::

## 文件存储 {#files}

以下所有限制均为**单应用**级别。

- 单文件大小：**30 MB**
- 文件总数：**100,000**，超过时会导致上传失败，建议将不用的文件及时删除

## 合理使用政策 {#fair-use-policy}

我们希望每一位用户在使用 AirCode 开发时遵循「合理使用」原则，当被判定为不合理使用时，我们有权在不经通知的情况下停止提供服务或回收资源。

### 合理使用的示例 {#examples-of-fair-use}

- 为前端/客户端应用提供后端接口
- 作为 Webhook 的回调地址
- 聊天机器人
- 自动化工作流
- 博客、电子商务、市场营销
- 更多合理的业务场景……

### 不合理使用示例 {#never-fair-use}

- 作为代理或 VPN
- 网络爬虫
- 数字矿币挖掘
- 其他违规或侵犯隐私的使用方式……
